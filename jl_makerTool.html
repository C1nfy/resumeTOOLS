<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ™ºèƒ½ç®€å†ç”Ÿæˆå™¨</title>
	
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: "Microsoft YaHei", Arial, sans-serif;
            background: #f0f2f5;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 550px 1fr;
            gap: 20px;
        }

        .form-panel {
            background: white;
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            height: fit-content;
            position: sticky;
            top: 20px;
            max-height: calc(100vh - 40px);
            overflow-y: auto;
        }

        .preview-panel {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        h2 {
            color: #333;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #607052;
        }

        .form-section {
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eee;
        }

        .form-section:last-child {
            border-bottom: none;
        }

        .form-section h3 {
            color: #607052;
            margin-bottom: 15px;
            font-size: 16px;
        }

        .form-group {
            margin-bottom: 12px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            color: #555;
            font-size: 14px;
            font-weight: 500;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
            font-family: inherit;
        }

        .form-group textarea {
            resize: vertical;
            min-height: 60px;
        }

        .form-group small {
            color: #999;
            font-size: 12px;
            display: block;
            margin-top: 3px;
        }

        .color-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .color-input {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .color-input input[type="color"] {
            width: 50px;
            height: 35px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        .color-input input[type="text"] {
            flex: 1;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s;
        }

        .btn-primary {
            background: #607052;
            color: white;
        }

        .btn-primary:hover {
            background: #4d5a42;
        }

        .btn-secondary {
            background: #A9B488;
            color: white;
            margin-left: 10px;
        }

        .btn-secondary:hover {
            background: #8a9470;
        }

        .btn-add {
            background: #B99471;
            color: white;
            width: 100%;
            margin-top: 10px;
        }

        .btn-add:hover {
            background: #9a7a5d;
        }

        .btn-remove {
            background: #dc3545;
            color: white;
            padding: 5px 10px;
            font-size: 12px;
        }

        .btn-remove:hover {
            background: #c82333;
        }

        .dynamic-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 15px;
            position: relative;
            border: 1px solid #e9ecef;
        }

        .dynamic-item .item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #dee2e6;
        }

        .dynamic-item .item-header h4 {
            color: #607052;
            font-size: 15px;
            margin: 0;
        }

        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .nested-item {
            background: white;
            padding: 12px;
            border-radius: 4px;
            margin-bottom: 10px;
            border: 1px solid #dee2e6;
        }

        .nested-item .item-header {
            margin-bottom: 10px;
        }

        .list-input-group {
            margin-bottom: 10px;
        }

        .list-input-item {
            display: flex;
            gap: 5px;
            margin-bottom: 5px;
        }

        .list-input-item input {
            flex: 1;
        }

        .list-input-item button {
            padding: 8px 12px;
            background: #dc3545;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }

        .btn-add-small {
            background: #28a745;
            color: white;
            padding: 6px 12px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            width: 100%;
            margin-top: 5px;
        }

        #resumePreview {
            min-height: 800px;
        }

        .checkbox-group {
            margin-top: 10px;
        }

        .checkbox-group label {
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: normal;
            cursor: pointer;
        }

        .checkbox-group input[type="checkbox"] {
            width: auto;
        }

        @media print {
            .container {
                grid-template-columns: 1fr;
            }
            .form-panel {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- è¡¨å•é¢æ¿ -->
        <div class="form-panel">
            <h2>ğŸ“ ç®€å†ç”Ÿæˆå™¨( à° àµ à°  )ï¾‰</h2>
			<span style="color:#9071b7;">author:æ™šæ™š</span></br>
<br>
			<span style="color: #fc1d55;">è«å…°è¿ªé…è‰²ä½ å€¼å¾—æ‹¥æœ‰!</span><br><br>

            <!-- é…è‰²æ–¹æ¡ˆ -->
            <div class="form-section">
                <h3>ğŸ¨ è‡ªå®šä¹‰é…è‰²æ–¹æ¡ˆ</h3>
                <div class="color-group">
                    <div class="form-group">
                        <label>ä¸»è‰²è°ƒï¼ˆæ·±è‰²ï¼‰</label>
                        <div class="color-input">
                            <input type="color" id="color1" value="#607052">
                            <input type="text" id="color1Text" value="#607052">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>è¾…åŠ©è‰²ï¼ˆä¸­è‰²ï¼‰</label>
                        <div class="color-input">
                            <input type="color" id="color2" value="#A9B488">
                            <input type="text" id="color2Text" value="#A9B488">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>èƒŒæ™¯è‰²ï¼ˆæµ…è‰²ï¼‰</label>
                        <div class="color-input">
                            <input type="color" id="color3" value="#FEFAE0">
                            <input type="text" id="color3Text" value="#FEFAE0">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>å¼ºè°ƒè‰²ï¼ˆç‚¹ç¼€ï¼‰</label>
                        <div class="color-input">
                            <input type="color" id="color4" value="#B99471">
                            <input type="text" id="color4Text" value="#B99471">
                        </div>
                    </div>
                </div>
            </div>

            <!-- åŸºæœ¬ä¿¡æ¯ -->
            <div class="form-section">
                <h3>ğŸ‘¤ åŸºæœ¬ä¿¡æ¯</h3>
                <div class="form-group">
                    <label>å§“å</label>
                    <input type="text" id="name" value="">
                </div>
                <div class="form-group">
                    <label>èŒä½</label>
                    <input type="text" id="position" value="">
                </div>
                <div class="form-group">
                    <label>ç”µè¯</label>
                    <input type="text" id="phone" value="">
                </div>
                <div class="form-group">
                    <label>é‚®ç®±</label>
                    <input type="text" id="email" value="">
                </div>
                <div class="form-group">
                    <label>å·¥ä½œå¹´é™</label>
                    <input type="text" id="workYears" value="">
                </div>
                <div class="form-group">
                    <label>å­¦å†</label>
                    <input type="text" id="education" value="">
                </div>
            </div>

            <!-- æ ¸å¿ƒæŠ€èƒ½ -->
            <div class="form-section">
                <h3>ğŸ’ª æ ¸å¿ƒæŠ€èƒ½</h3>
                <div id="skillsContainer"></div>
                <button class="btn btn-add" onclick="addSkillCategory()">+ æ·»åŠ æŠ€èƒ½ç±»åˆ«</button>
            </div>

            <!-- å·¥ä½œç»å† -->
            <div class="form-section">
                <h3>ğŸ’¼ å·¥ä½œç»å†</h3>
                <div id="experienceContainer"></div>
                <button class="btn btn-add" onclick="addExperience()">+ æ·»åŠ å·¥ä½œç»å†</button>
            </div>

            <!-- æ•™è‚²èƒŒæ™¯ -->
            <div class="form-section">
                <h3>ğŸ“ æ•™è‚²èƒŒæ™¯</h3>
                <div class="form-group">
                    <label>å­¦æ ¡</label>
                    <input type="text" id="school" value="">
                </div>
                <div class="form-group">
                    <label>å­¦å†</label>
                    <input type="text" id="degree" value="">
                </div>
                <div class="form-group">
                    <label>æ—¶é—´</label>
                    <input type="text" id="eduTime" value="">
                </div>
            </div>

            <!-- è¯ä¹¦ -->
            <div class="form-section">
                <h3>ğŸ“œ ä¸“ä¸šè¯ä¹¦</h3>
                <div class="form-group">
                    <label>è¯ä¹¦åˆ—è¡¨ï¼ˆç”¨é¡¿å·æˆ–é€—å·åˆ†éš”ï¼‰</label>
                    <textarea id="certificates"></textarea>
                </div>
            </div>

            <!-- ä¸ªäººè¯„ä»· -->
            <div class="form-section">
                <h3>âœ¨ ä¸ªäººè¯„ä»·</h3>
                <div id="summaryContainer"></div>
                <button class="btn btn-add" onclick="addSummary()">+ æ·»åŠ è¯„ä»·</button>
            </div>

            <div class="button-group">
                <button class="btn btn-primary" onclick="generateResume()">ç”Ÿæˆç®€å†</button>
                <button class="btn btn-secondary" onclick="window.print()">æ‰“å°ç®€å†</button>
            </div>
        </div>

        <!-- é¢„è§ˆé¢æ¿ -->
        <div class="preview-panel" id="resumePreview">
            <div style="padding: 40px; text-align: center; color: #999;">
                ç‚¹å‡»"ç”Ÿæˆç®€å†"æŒ‰é’®é¢„è§ˆæ•ˆæœ
            </div>
        </div>
    </div>

    <script>
        // æ•°æ®å­˜å‚¨
        let skillCategories = [];
        let experiences = [];
        let summaries = [];

        // é¢œè‰²é€‰æ‹©å™¨åŒæ­¥
        ['color1', 'color2', 'color3', 'color4'].forEach(id => {
            const colorInput = document.getElementById(id);
            const textInput = document.getElementById(id + 'Text');
            
            colorInput.addEventListener('input', (e) => {
                textInput.value = e.target.value;
            });
            
            textInput.addEventListener('input', (e) => {
                if (/^#[0-9A-F]{6}$/i.test(e.target.value)) {
                    colorInput.value = e.target.value;
                }
            });
        });

        // ========== æŠ€èƒ½ç®¡ç† ==========
        function addSkillCategory() {
            const id = Date.now();
            skillCategories.push({ 
                id, 
                category: '',
                skills: []
            });
            renderSkills();
        }

        function renderSkills() {
            const container = document.getElementById('skillsContainer');
            container.innerHTML = skillCategories.map((cat, catIndex) => `
                <div class="dynamic-item">
                    <div class="item-header">
                        <h4>æŠ€èƒ½ç±»åˆ« ${catIndex + 1}</h4>
                        <button class="btn btn-remove" onclick="removeSkillCategory(${cat.id})">åˆ é™¤</button>
                    </div>
                    <div class="form-group">
                        <label>ç±»åˆ«åç§°</label>
                        <input type="text" value="${cat.category}" 
                               onchange="skillCategories[${catIndex}].category = this.value"
                               placeholder="ä¾‹å¦‚ï¼šæµ‹è¯•ä¸“é¡¹èƒ½åŠ›">
                    </div>
                    <div class="list-input-group">
                        <label>æŠ€èƒ½åˆ—è¡¨</label>
                        ${cat.skills.map((skill, skillIndex) => `
                            <div class="list-input-item">
                                <input type="text" value="${skill.name}" 
                                       onchange="skillCategories[${catIndex}].skills[${skillIndex}].name = this.value"
                                       placeholder="æŠ€èƒ½åç§°ï¼Œä¾‹å¦‚ï¼šåŠŸèƒ½æµ‹è¯•" style="flex: 0.3;">
                                <input type="text" value="${skill.desc}" 
                                       onchange="skillCategories[${catIndex}].skills[${skillIndex}].desc = this.value"
                                       placeholder="æŠ€èƒ½æè¿°ï¼Œä¾‹å¦‚ï¼šç²¾é€š C ç«¯ã€B ç«¯æµ‹è¯•">
                                <button onclick="removeSkill(${catIndex}, ${skillIndex}); renderSkills();">åˆ é™¤</button>
                            </div>
                        `).join('')}
                        <button class="btn-add-small" onclick="addSkill(${catIndex})">+ æ·»åŠ æŠ€èƒ½</button>
                    </div>
                </div>
            `).join('');
        }

        function addSkill(catIndex) {
            skillCategories[catIndex].skills.push({ name: '', desc: '' });
            renderSkills();
        }

        function removeSkill(catIndex, skillIndex) {
            skillCategories[catIndex].skills.splice(skillIndex, 1);
        }

        function removeSkillCategory(id) {
            skillCategories = skillCategories.filter(c => c.id !== id);
            renderSkills();
        }

        // ========== å·¥ä½œç»å†ç®¡ç† ==========
        function addExperience() {
            const id = Date.now();
            experiences.push({
                id,
                company: '',
                position: '',
                duration: '',
                projects: []
            });
            renderExperiences();
        }

        function renderExperiences() {
            const container = document.getElementById('experienceContainer');
            container.innerHTML = experiences.map((exp, expIndex) => `
                <div class="dynamic-item">
                    <div class="item-header">
                        <h4>å·¥ä½œç»å† ${expIndex + 1}</h4>
                        <button class="btn btn-remove" onclick="removeExperience(${exp.id})">åˆ é™¤</button>
                    </div>
                    <div class="form-group">
                        <label>å…¬å¸åç§°</label>
                        <input type="text" value="${exp.company}" 
                               onchange="experiences[${expIndex}].company = this.value"
                               placeholder="">
                    </div>
                    <div class="form-group">
                        <label>èŒä½</label>
                        <input type="text" value="${exp.position}" 
                               onchange="experiences[${expIndex}].position = this.value"
                               placeholder="">
                    </div>
                    <div class="form-group">
                        <label>åœ¨èŒæ—¶é—´</label>
                        <input type="text" value="${exp.duration}" 
                               onchange="experiences[${expIndex}].duration = this.value"
                               placeholder="">
                    </div>
                    
                    <div style="margin-top: 15px;">
                        <label style="font-weight: bold; color: #607052;">é¡¹ç›®åˆ—è¡¨</label>
                        ${exp.projects.map((proj, projIndex) => `
                            <div class="nested-item">
                                <div class="item-header">
                                    <h4>é¡¹ç›® ${projIndex + 1}: ${proj.name || 'æœªå‘½å'}</h4>
                                    <button class="btn btn-remove" onclick="removeProject(${expIndex}, ${projIndex})">åˆ é™¤é¡¹ç›®</button>
                                </div>
                                <div class="form-group">
                                    <label>é¡¹ç›®åç§°</label>
                                    <input type="text" value="${proj.name}" 
                                           onchange="experiences[${expIndex}].projects[${projIndex}].name = this.value"
                                           placeholder="">
                                </div>
                                <div class="form-group">
                                    <label>é¡¹ç›®ç±»å‹</label>
                                    <input type="text" value="${proj.type}" 
                                           onchange="experiences[${expIndex}].projects[${projIndex}].type = this.value"
                                           placeholder="">
                                </div>
                                <div class="form-group">
                                    <label>è´Ÿè´£ä¸šåŠ¡</label>
                                    <textarea onchange="experiences[${expIndex}].projects[${projIndex}].business = this.value"
                                              placeholder="">${proj.business}</textarea>
                                </div>
                                <div class="list-input-group">
                                    <label>å·¥ä½œèŒè´£</label>
                                    ${proj.duties.map((duty, dutyIndex) => `
                                        <div class="list-input-item">
                                            <input type="text" value="${duty}" 
                                                   onchange="experiences[${expIndex}].projects[${projIndex}].duties[${dutyIndex}] = this.value"
                                                   placeholder="è¾“å…¥ä¸€æ¡å·¥ä½œèŒè´£">
                                            <button onclick="removeDuty(${expIndex}, ${projIndex}, ${dutyIndex})">åˆ é™¤</button>
                                        </div>
                                    `).join('')}
                                    <button class="btn-add-small" onclick="addDuty(${expIndex}, ${projIndex})">+ æ·»åŠ èŒè´£</button>
                                </div>
                                
                                <div class="checkbox-group">
                                    <label>
                                        <input type="checkbox" ${proj.hasTechContribution ? 'checked' : ''}
                                               onchange="toggleTechContribution(${expIndex}, ${projIndex}, this.checked)">
                                        æ·»åŠ æŠ€æœ¯è´¡çŒ®
                                    </label>
                                </div>
                                
                                ${proj.hasTechContribution ? `
                                    <div style="margin-top: 10px; padding: 10px; background: #fff; border-radius: 4px;">
                                        ${proj.techContributions.map((tech, techIndex) => `
                                            <div style="margin-bottom: 10px; padding-bottom: 10px; border-bottom: 1px solid #eee;">
                                                <div class="form-group">
                                                    <label>æŠ€æœ¯è´¡çŒ®æ ‡é¢˜</label>
                                                    <input type="text" value="${tech.title}" 
                                                           onchange="experiences[${expIndex}].projects[${projIndex}].techContributions[${techIndex}].title = this.value"
                                                           placeholder="">
                                                </div>
                                                <div class="list-input-group">
                                                    <label>è´¡çŒ®è¯¦æƒ…</label>
                                                    ${tech.items.map((item, itemIndex) => `
                                                        <div class="list-input-item">
                                                            <input type="text" value="${item}" 
                                                                   onchange="experiences[${expIndex}].projects[${projIndex}].techContributions[${techIndex}].items[${itemIndex}] = this.value"
                                                                   placeholder="">
                                                            <button onclick="removeTechItem(${expIndex}, ${projIndex}, ${techIndex}, ${itemIndex})">åˆ é™¤</button>
                                                        </div>
                                                    `).join('')}
                                                    <button class="btn-add-small" onclick="addTechItem(${expIndex}, ${projIndex}, ${techIndex})">+ æ·»åŠ è¯¦æƒ…</button>
                                                </div>
                                                <button class="btn btn-remove" style="margin-top: 5px;" 
                                                        onclick="removeTechContribution(${expIndex}, ${projIndex}, ${techIndex})">åˆ é™¤æ­¤æŠ€æœ¯è´¡çŒ®</button>
                                            </div>
                                        `).join('')}
                                        <button class="btn-add-small" onclick="addTechContribution(${expIndex}, ${projIndex})">+ æ·»åŠ æŠ€æœ¯è´¡çŒ®</button>
                                    </div>
                                ` : ''}
                                
                                <div class="form-group" style="margin-top: 10px;">
                                    <label>é¡¹ç›®æˆæœ</label>
                                    <textarea onchange="experiences[${expIndex}].projects[${projIndex}].achievement = this.value"
                                              placeholder="">${proj.achievement}</textarea>
                                </div>
                            </div>
                        `).join('')}
                        <button class="btn-add-small" onclick="addProject(${expIndex})">+ æ·»åŠ é¡¹ç›®</button>
                    </div>
                </div>
            `).join('');
        }

        function addProject(expIndex) {
            experiences[expIndex].projects.push({
                name: '',
                type: '',
                business: '',
                duties: [],
                hasTechContribution: false,
                techContributions: [],
                achievement: ''
            });
            renderExperiences();
        }

        function removeProject(expIndex, projIndex) {
            experiences[expIndex].projects.splice(projIndex, 1);
            renderExperiences();
        }

        function addDuty(expIndex, projIndex) {
            experiences[expIndex].projects[projIndex].duties.push('');
            renderExperiences();
        }

        function removeDuty(expIndex, projIndex, dutyIndex) {
            experiences[expIndex].projects[projIndex].duties.splice(dutyIndex, 1);
            renderExperiences();
        }

        function toggleTechContribution(expIndex, projIndex, checked) {
            experiences[expIndex].projects[projIndex].hasTechContribution = checked;
            if (checked && experiences[expIndex].projects[projIndex].techContributions.length === 0) {
                experiences[expIndex].projects[projIndex].techContributions.push({
                    title: '',
                    items: []
                });
            }
            renderExperiences();
        }

        function addTechContribution(expIndex, projIndex) {
            experiences[expIndex].projects[projIndex].techContributions.push({
                title: '',
                items: []
            });
            renderExperiences();
        }

        function removeTechContribution(expIndex, projIndex, techIndex) {
            experiences[expIndex].projects[projIndex].techContributions.splice(techIndex, 1);
            renderExperiences();
        }

        function addTechItem(expIndex, projIndex, techIndex) {
            experiences[expIndex].projects[projIndex].techContributions[techIndex].items.push('');
            renderExperiences();
        }

        function removeTechItem(expIndex, projIndex, techIndex, itemIndex) {
            experiences[expIndex].projects[projIndex].techContributions[techIndex].items.splice(itemIndex, 1);
            renderExperiences();
        }

        function removeExperience(id) {
            experiences = experiences.filter(e => e.id !== id);
            renderExperiences();
        }

        // ========== ä¸ªäººè¯„ä»·ç®¡ç† ==========
        function addSummary() {
            const id = Date.now();
            summaries.push({ id, title: '', content: '' });
            renderSummaries();
        }

        function renderSummaries() {
            const container = document.getElementById('summaryContainer');
            container.innerHTML = summaries.map((summary, index) => `
                <div class="dynamic-item">
                    <div class="item-header">
                        <h4>è¯„ä»· ${index + 1}</h4>
                        <button class="btn btn-remove" onclick="removeSummary(${summary.id})">åˆ é™¤</button>
                    </div>
                    <div class="form-group">
                        <label>æ ‡é¢˜</label>
                        <input type="text" value="${summary.title}" 
                               onchange="summaries[${index}].title = this.value"
                               placeholder="">
                    </div>
                    <div class="form-group">
                        <label>å†…å®¹</label>
                        <textarea onchange="summaries[${index}].content = this.value"
                                  placeholder="">${summary.content}</textarea>
                    </div>
                </div>
            `).join('');
        }

        function removeSummary(id) {
            summaries = summaries.filter(s => s.id !== id);
            renderSummaries();
        }

        // ========== ç”Ÿæˆç®€å† ==========
        function generateResume() {
            const colors = {
                primary: document.getElementById('color1').value,
                secondary: document.getElementById('color2').value,
                background: document.getElementById('color3').value,
                accent: document.getElementById('color4').value
            };

            const basic = {
                name: document.getElementById('name').value,
                position: document.getElementById('position').value,
                phone: document.getElementById('phone').value,
                email: document.getElementById('email').value,
                workYears: document.getElementById('workYears').value,
                education: document.getElementById('education').value
            };

            const edu = {
                school: document.getElementById('school').value,
                degree: document.getElementById('degree').value,
                time: document.getElementById('eduTime').value
            };

            const certificates = document.getElementById('certificates').value;

            const html = `
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>${basic.name} - ${basic.position}ç®€å†</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: "Microsoft YaHei", Arial, sans-serif; line-height: 1.6; color: #333; background: #f5f5f5; padding: 20px; }
        .resume-container { max-width: 900px; margin: 0 auto; background: white; box-shadow: 0 0 10px rgba(0,0,0,0.08); }
        .header { background: linear-gradient(135deg, ${colors.primary}dd 0%, ${colors.secondary}dd 100%); color: white; padding: 35px 40px; text-align: center; }
        .header h1 { font-size: 34px; margin-bottom: 8px; }
        .header .job-title { font-size: 19px; margin-bottom: 15px; }
        .contact-info { display: flex; justify-content: center; flex-wrap: wrap; gap: 15px; font-size: 14px; }
        .contact-item { display: flex; align-items: center; gap: 5px; }
        .content { padding: 35px 40px; }
        .section { margin-bottom: 30px; }
        .section-title { font-size: 22px; color: ${colors.primary}e6; border-bottom: 2px solid ${colors.secondary}99; padding-bottom: 8px; margin-bottom: 20px; font-weight: bold; }
        .skill-category { margin-bottom: 12px; }
        .skill-category-title { font-weight: bold; color: ${colors.primary}dd; margin-bottom: 8px; font-size: 16px; }
        .skill-list { padding-left: 20px; color: #374151; }
        .skill-list li { margin-bottom: 6px; }
        .experience-item { margin-bottom: 20px; }
        .experience-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .experience-title { font-size: 18px; font-weight: bold; color: ${colors.primary}dd; }
        .experience-duration { color: #666; font-size: 14px; }
        .project-item { margin-bottom: 15px; padding: 15px; background: #f9fafb; border-radius: 6px; }
        .project-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .project-name { font-weight: bold; color: ${colors.secondary}; }
        .project-type { color: #666; font-size: 14px; }
        .duty-list { padding-left: 20px; margin: 10px 0; }
        .duty-list li { margin-bottom: 5px; }
        .tech-contribution { margin-top: 15px; padding: 12px; background: #f0f9ff; border-left: 4px solid ${colors.accent}; }
        .tech-title { font-weight: bold; color: ${colors.accent}; margin-bottom: 8px; }
        .tech-items { padding-left: 15px; }
        .tech-items li { margin-bottom: 5px; }
        .summary-item { margin-bottom: 15px; }
        .summary-title { font-weight: bold; color: ${colors.primary}; margin-bottom: 5px; }
        .certificate-list { padding-left: 20px; }
        .certificate-list li { margin-bottom: 5px; }
        .education-item { margin-bottom: 15px; }
        .education-header { display: flex; justify-content: space-between; align-items: center; }
        .edu-school { font-weight: bold; color: ${colors.primary}; }
        .edu-time { color: #666; }
        .edu-degree { color: #666; }
        @media print {
            body { padding: 0; background: white; }
            .resume-container { box-shadow: none; margin: 0; }
        }
    </style>
</head>
<body>
    <div class="resume-container">
        <div class="header">
            <h1>${basic.name}</h1>
            <div class="job-title">${basic.position}</div>
            <div class="contact-info">
                <div class="contact-item">ğŸ“ ${basic.phone}</div>
                <div class="contact-item">âœ‰ï¸ ${basic.email}</div>
                <div class="contact-item">ğŸ’¼ ${basic.workYears}</div>
                <div class="contact-item">ğŸ“ ${basic.education}</div>
            </div>
        </div>
        
        <div class="content">
            <div class="section">
                <h2 class="section-title">æ ¸å¿ƒæŠ€èƒ½</h2>
                ${skillCategories.map(cat => `
                    <div class="skill-category">
                        <div class="skill-category-title">${cat.category}</div>
                        <ul class="skill-list">
                            ${cat.skills.map(skill => `
                                <li><strong>${skill.name}:</strong> ${skill.desc}</li>
                            `).join('')}
                        </ul>
                    </div>
                `).join('')}
            </div>
            
            <div class="section">
                <h2 class="section-title">å·¥ä½œç»å†</h2>
                ${experiences.map(exp => `
                    <div class="experience-item">
                        <div class="experience-header">
                            <div class="experience-title">${exp.company}</div>
                            <div class="experience-duration">${exp.duration}</div>
                        </div>
                        <div>èŒä½ï¼š${exp.position}</div>
                        
                        ${exp.projects.map(proj => `
                            <div class="project-item">
                                <div class="project-header">
                                    <div class="project-name">${proj.name}</div>
                                    <div class="project-type">${proj.type}</div>
                                </div>
                                <div><strong>è´Ÿè´£ä¸šåŠ¡ï¼š</strong>${proj.business}</div>
                                
                                ${proj.duties && proj.duties.length > 0 ? `
                                    <div><strong>å·¥ä½œèŒè´£ï¼š</strong></div>
                                    <ul class="duty-list">
                                        ${proj.duties.map(duty => `<li>${duty}</li>`).join('')}
                                    </ul>
                                ` : ''}
                                
                                ${proj.techContributions && proj.techContributions.length > 0 ? `
                                    <div class="tech-contribution">
                                        <div class="tech-title">æŠ€æœ¯è´¡çŒ®</div>
                                        ${proj.techContributions.map(tech => `
                                            <div>
                                                <strong>${tech.title}</strong>
                                                <ul class="tech-items">
                                                    ${tech.items.map(item => `<li>${item}</li>`).join('')}
                                                </ul>
                                            </div>
                                        `).join('')}
                                    </div>
                                ` : ''}
                                
                                ${proj.achievement ? `<div><strong>é¡¹ç›®æˆæœï¼š</strong>${proj.achievement}</div>` : ''}
                            </div>
                        `).join('')}
                    </div>
                `).join('')}
            </div>
            
            <div class="section">
                <h2 class="section-title">æ•™è‚²èƒŒæ™¯</h2>
                <div class="education-item">
                    <div class="education-header">
                        <div class="edu-school">${edu.school}</div>
                        <div class="edu-time">${edu.time}</div>
                    </div>
                    <div class="edu-degree">${edu.degree}</div>
                </div>
            </div>
            
            <div class="section">
                <h2 class="section-title">ä¸“ä¸šè¯ä¹¦</h2>
                <ul class="certificate-list">
                    ${certificates.split(/[ï¼Œã€]/).map(cert => `<li>${cert.trim()}</li>`).join('')}
                </ul>
            </div>
            
            <div class="section">
                <h2 class="section-title">ä¸ªäººè¯„ä»·</h2>
                ${summaries.map(summary => `
                    <div class="summary-item">
                        <div class="summary-title">${summary.title}</div>
                        <div>${summary.content}</div>
                    </div>
                `).join('')}
            </div>
        </div>
    </div>
</body>
</html>`;
            
            // åœ¨æ–°çª—å£ä¸­æ‰“å¼€ç”Ÿæˆçš„ç®€å†
            const newWindow = window.open('', '_blank');
            newWindow.document.write(html);
            newWindow.document.close();
        }
    </script>
</body>
</html>